<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="sunhuachuang huachuang20 homepage blog 孙华闯 个人博客 技术文章 php symfony doctrine">
    <meta name="author" content="sunhuachuang">
    <link rel="icon" href="/images/favicon.ico">
    <title>Sunhuachuang Blog</title>
    <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
  </head>
  <body>
    <div class="container">
      <div>
        <h2 class="text-success">Happy Hacking Sun. Happy Everyone !</h2>
      </div>
      <hr>
      <a href="/index.html" class="btn btn-success"><< Blog Index</a>
      <h3 class="text-primary"><b>在操作数据库前监听doctrine事件</b></h3>
      <hr>
      <div class="row">
        <div class="col-sm-8">
          <p>使用场景为：每次操作数据库前后可以监听到。通过doctrine给定的监听机制。
            scenes to be used: if you want to listen when operate database, doctrine give some listener for you.</p>
          <h3>code</h3>
          <pre>
//AppBundle\EventListener\
use Doctrine\ORM\Event\PreFlushEventArgs;
use Symfony\Component\DependencyInjection\ContainerInterface as Container;</p>

class PreFlushExampleListener
{
    private $container;

    public function __construct(Container $container) {
        $this-&gt;container = $container;
    }

    public function preFlush(PreFlushEventArgs $args)
    {
        //you can do anything here
        die('haved persist, wait flush')
    }
}
          </pre>
          <pre>
service:
    app.pre_flush_example_listener:
        class: AppBundle\EventListener\PreFlushExampleListener
            arguments: ['@service_container']
        tags:
            - { name: doctrine.event_listener, event: preFlush }
          </pre>
          <p>that is enough...</p>
          <p>there is also have some listener <a href="http://doctrine-orm.readthedocs.org/projects/doctrine-orm/en/latest/reference/events.html">doctrine listener</a>  </p>
          <p>only change preflush for what you want.</p>
          <nav>
            <ul class="pager">
              <li style="float:left;padding-left:2em;"><a href="/php/module-already-load.html"><< PHP module warning</a></li>
              <li style="float:right;padding-right:2em;"><a href="/php/restful-api-login-register-fosuerbundle-symfony3-guard.html">restful symfony >></a></li>
            </ul>
          </nav>
        </div>
        <div class="col-sm-3 col-sm-offset-1">
          <div>
            <h4>About Me</h4>
            <p>Name: <em>sunhuachuang (孙华闯)</em></p>
            <p><a href="/about_en.html">English Introduction</a> <a href="/about_zh.html">中文简介</a></p>
          </div>
          <hr>
          <div>
            <h4>Archives</h4>
            <ol class="list-unstyled">
              <li><a href="/2018.html">2018</a></li>
              <li><a href="/2017.html">2017</a></li>
              <li><a href="/2016.html">2016</a></li>
            </ol>
          </div>
          <hr>
          <div>
            <h4>Elsewhere</h4>
            <ol class="list-unstyled">
              <li><p class="text-success">E: huachuang20@gmail.com</p></li>
              <li><a href="https://github.com/sunhuachuang">GitHub</a></li>
              <li><a href="http://weibo.com/u/3268988844?is_all=1">WeiBo</a></li>
              <li><a href="https://www.linkedin.com/in/huachuang-sun-6548a3105">Linkedin</a></li>
              <li><a href="https://twitter.com/huachuang20">Twitter</a></li>
            </ol>
          </div>
        </div>
      </div>
      <hr>
    </div>
  </body>
</html>
